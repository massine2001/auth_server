<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Connexion</title>
    <style>
        :root{
            --bg:#f6f7f9;
            --card:#fff;
            --text:#0f172a;
            --muted:#6b7280;
            --primary:#0d6efd;
            --primary-600:#0b5ed7;
            --ring:#93c5fd;
            --notif-bg:#eaf4ff;
            --notif-border:#cfe6ff;
            --notif-text:#0b3b73;
            --error:#dc2626;
            --success:#16a34a;
            --radius:12px;
            --shadow:0 6px 18px rgba(16,24,40,.08);
            --shadow-soft:0 1px 2px rgba(16,24,40,.06);
        }

        *{box-sizing:border-box}
        html,body{height:100%}
        body{
            margin:0;
            font-family:ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
            background:var(--bg);
            color:var(--text);
            display:flex;
            align-items:center;
            justify-content:center;
            padding:24px;
        }

        form{
            background:var(--card);
            width:clamp(320px, 92vw, 420px);
            padding:24px 24px 20px;
            border-radius:var(--radius);
            box-shadow:var(--shadow);
        }

        h1{
            margin:10px 0 18px;
            font-size:1.5rem;
            font-weight:700;
            text-align:center;
            letter-spacing:.2px;
        }

        .notif{
            display:block;
            margin-bottom:14px;
            padding:12px 14px;
            border-radius:10px;
            background:var(--notif-bg);
            border:1px solid var(--notif-border);
            color:var(--notif-text);
            font-size:.95rem;
            line-height:1.35;
            text-align:center;
            box-shadow:var(--shadow-soft);
        }
        .notif strong{font-weight:600}

        .field{
            display:flex;
            flex-direction:column;
            gap:6px;
            margin-bottom:12px;
        }

        input{
            width:100%;
            appearance:none;
            background:#fff;
            border:1px solid #d1d5db;
            border-radius:10px;
            padding:12px 14px;
            font-size:.98rem;
            outline:none;
            transition:border-color .15s ease, box-shadow .15s ease;
        }
        input::placeholder{color:#9ca3af}
        input:focus{
            border-color:var(--primary);
            box-shadow:0 0 0 4px var(--ring);
        }

        button{
            width:100%;
            border:0;
            border-radius:10px;
            padding:12px 16px;
            font-weight:600;
            font-size:1rem;
            background:var(--primary);
            color:#fff;
            cursor:pointer;
            transition:background .15s ease, transform .02s ease-in;
        }
        button:hover{background:var(--primary-600)}
        button:active{transform:translateY(1px)}

        .error{
            color:var(--error);
            background:#fee2e2;
            border:1px solid #fecaca;
            padding:10px 12px;
            border-radius:10px;
            font-size:.92rem;
            text-align:center;
            margin-bottom:12px;
        }
        .success{
            color:var(--success);
            background:#dcfce7;
            border:1px solid #bbf7d0;
            padding:10px 12px;
            border-radius:10px;
            font-size:.92rem;
            text-align:center;
            margin-bottom:12px;
        }

        .links{
            text-align:center;
            font-size:.95rem;
            margin-top:14px;
            color:var(--muted);
            display:flex;
            justify-content:center;
            gap:10px;
            flex-wrap:wrap;
        }
        .links a{
            color:var(--primary);
            text-decoration:none;
        }
        .links a:hover{text-decoration:underline}
    </style>
</head>
<body>
<div th:replace="fragments/header :: mainHeader"></div>

<form th:action="@{/login}" method="post">
    <div class="notif">
        <strong>Connectez-vous en tant qu'invité pour tester !</strong>
        <br><strong>Email :</strong> test
        <br><strong>Mot de passe :</strong> test
    </div>

    <h1>Connexion</h1>

    <div th:if="${param.error}" class="error">
        Nom d'utilisateur ou mot de passe invalide.
    </div>
    <div th:if="${param.logout}" class="success">
        Déconnecté avec succès.
    </div>
    <div th:if="${param.verified}" class="success">
        Votre e-mail a été vérifié. Vous pouvez maintenant vous connecter.
    </div>

    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

    <div class="field">
        <input type="text" name="username" placeholder="Adresse e-mail" required autofocus/>
    </div>

    <div class="field">
        <input type="password" name="password" placeholder="Mot de passe" required/>
    </div>

    <button type="submit">Se connecter</button>

    <div class="links">
        <a th:href="@{/register(loginUrl=${loginUrl})}">Créer un compte</a>
        <span>•</span>
        <a th:href="@{/forgot-password}">Mot de passe oublié ?</a>
    </div>
</form>

<div th:replace="fragments/footer :: mainFooter"></div>
</body>
</html>
