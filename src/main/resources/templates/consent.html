<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Consentement</title>
    <style>
        :root{
            --bg:#f6f7f9;
            --card:#fff;
            --text:#0f172a;
            --muted:#6b7280;
            --primary:#0d6efd;
            --primary-600:#0b5ed7;
            --success:#16a34a;
            --danger:#dc2626;
            --radius:12px;
            --shadow:0 6px 18px rgba(16,24,40,.08);
            --shadow-soft:0 1px 2px rgba(16,24,40,.06);
        }

        *{box-sizing:border-box;margin:0;padding:0}
        html,body{height:100%}
        body{
            font-family:ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
            background:var(--bg);
            color:var(--text);
            display:flex;
            align-items:center;
            justify-content:center;
            padding:24px;
        }

        .box{
            background:var(--card);
            width:clamp(320px, 90vw, 480px);
            padding:28px 26px 26px;
            border-radius:var(--radius);
            box-shadow:var(--shadow);
        }

        h1{
            font-size:1.5rem;
            font-weight:700;
            text-align:center;
            margin-bottom:1.4rem;
            color:var(--primary);
        }

        p{
            text-align:center;
            margin-bottom:1.2rem;
            color:var(--muted);
            font-size:1rem;
        }

        ul{
            list-style:none;
            padding:0;
            margin:0 0 1rem;
        }

        li{
            margin-bottom:.6rem;
            background:#f9fafb;
            padding:.6rem .8rem;
            border-radius:8px;
            border:1px solid #e5e7eb;
            display:flex;
            align-items:center;
            gap:.5rem;
            font-size:.95rem;
        }

        input[type="checkbox"]{
            width:16px;
            height:16px;
            accent-color:var(--primary);
        }

        .actions{
            display:flex;
            justify-content:center;
            gap:.8rem;
            margin-top:1rem;
        }

        button{
            padding:.6rem 1.2rem;
            border:none;
            border-radius:10px;
            cursor:pointer;
            font-weight:600;
            font-size:.98rem;
            transition:background .15s ease, transform .02s ease-in;
        }

        button.approve{
            background:var(--success);
            color:#fff;
        }
        button.approve:hover{background:#15803d}
        button.deny{
            background:var(--danger);
            color:#fff;
        }
        button.deny:hover{background:#b91c1c}
        button:active{transform:translateY(1px)}
    </style>
</head>
<body>
<div class="box">
    <h1>Consentement d'accès</h1>
    <p>
        L'application <strong th:text="${clientName}"></strong> demande l'accès à vos données :
    </p>

    <form th:action="@{/oauth2/authorize}" method="post">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <input type="hidden" name="client_id" th:value="${clientId}" />
        <input type="hidden" name="state" th:value="${state}" />
        <input type="hidden" name="scope" th:value="${scope}" />
        <input type="hidden" name="redirect_uri" th:value="${redirectUri}" />

        <ul>
            <li th:each="scope : ${scopesToApprove}">
                <label>
                    <input type="checkbox" th:name="'scope.' + ${scope}" checked />
                    <span th:text="${scope}"></span>
                </label>
            </li>
        </ul>

        <div class="actions">
            <button class="approve" type="submit" name="consent_action" value="approve">Autoriser</button>
            <button class="deny" type="submit" name="consent_action" value="cancel">Refuser</button>
        </div>
    </form>
</div>

<div th:replace="fragments/footer :: mainFooter"></div>
</body>
</html>
