<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consentement</title>
    <style>
        body { font-family:sans-serif; display:flex; align-items:center; justify-content:center; height:100vh; background:#f8f9fa; }
        .box { background:white; padding:2rem; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.1); width:400px; }
        h1 { font-size:1.2rem; text-align:center; margin-bottom:1.5rem; }
        ul { list-style:none; padding:0; }
        li { margin-bottom:0.5rem; }
        button { padding:0.5rem 1rem; margin:0.5rem; border:none; border-radius:4px; cursor:pointer; }
        .approve { background:#28a745; color:white; }
        .deny { background:#dc3545; color:white; }
    </style>
</head>
<body>
<div class="box">
    <h1>Consentement d'accès</h1>
    <p>
        L'application <strong th:text="${clientName}"></strong> demande l'accès à vos données :
    </p>
    <form th:action="@{/oauth2/authorize}" method="post">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
        <input type="hidden" name="client_id" th:value="${clientId}"/>
        <input type="hidden" name="state" th:value="${state}"/>
        <input type="hidden" name="scope" th:value="${scope}"/>
        <input type="hidden" name="redirect_uri" th:value="${redirectUri}"/>

        <ul>
            <li th:each="scope : ${scopesToApprove}">
                <label>
                    <input type="checkbox" th:name="'scope.' + ${scope}" checked>
                    <span th:text="${scope}"></span>
                </label>
            </li>
        </ul>

        <div style="text-align:center;">
            <button class="approve" type="submit" name="consent_action" value="approve">Autoriser</button>
            <button class="deny" type="submit" name="consent_action" value="cancel">Refuser</button>
        </div>
    </form>
</div>
</body>
</html>
